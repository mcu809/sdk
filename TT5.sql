CREATE TABLE DEPT
(
    DNO INT,
    DNAME VARCHAR(20),
    MGRSSN INT,
    MGRSTARTDATE DATE,
    PRIMARY KEY(DNO)
);

INSERT INTO DEPT VALUES(1, 'ACCOUNT', NULL, '01-DEC-2017');
INSERT INTO DEPT VALUES(2, 'MARKETING', NULL, '02-DEC-2017');
INSERT INTO DEPT VALUES(3, 'PRODUCTION', NULL, '03-DEC-2017');
INSERT INTO DEPT VALUES(4, 'RND', NULL, '04-DEC-2017');
INSERT INTO DEPT VALUES(5, 'MANAGEMENT', 33, '05-DEC-2017');

CREATE TABLE EMP
(
    SSN INT ,
    NAME VARCHAR(20),
    ADDRESS VARCHAR(20),
    SEX VARCHAR(1),
    SALARY INT,
    SUPERSSN INT,
    DNO INT,
    PRIMARY KEY (SSN),
    FOREIGN KEY (SUPERSSN) REFERENCES EMP (SSN),
    FOREIGN KEY (DNO) REFERENCES DEPT (DNO)
);

INSERT INTO EMP VALUES(1, 'JAMES', 'NY','M', 100000, 1, 1);
INSERT INTO EMP VALUES(2, 'MARKUS', 'NY','M', 200000, 1, 2);
INSERT INTO EMP VALUES(3, 'JOEL', 'NY','M', 300000, 1, 3);
INSERT INTO EMP VALUES(4, 'LUKE', 'TX','M', 400000, 1, 4);
INSERT INTO EMP VALUES(5, 'ALYSON SCOTT', 'TX','F', 50000, 1, 4);
INSERT INTO EMP VALUES(6, 'JAMIE SCOTT', 'TX','F', 600000, 1, 4);
INSERT INTO EMP VALUES(7, 'LOMA SCOTT', 'TN','F', 700000, 1, 4);
INSERT INTO EMP VALUES(8, 'OATS SCOTT', 'TN','M', 800000, 1, 4);
INSERT INTO EMP VALUES(9, 'MIKE SCOTT', 'TN','M', 900000, 1, 4);

CREATE TABLE DLOCATION
(
    DNO INT,
    DLOC VARCHAR(5),
    PRIMARY KEY(DNO),
    FOREIGN KEY(DNO) REFERENCES DEPT(DNO)
);
INSERT INTO DLOCATION VALUES(1, 'NY');
INSERT INTO DLOCATION VALUES(2, 'TX');
INSERT INTO DLOCATION VALUES(3, 'TN');
INSERT INTO DLOCATION VALUES(4, 'CA');

CREATE TABLE PROJECT
(
    PNO INT,
    PNAME VARCHAR(20),
    PLOCATION VARCHAR(20),
    DNO INT,
    PRIMARY KEY(PNO),
    FOREIGN KEY(DNO) REFERENCES DEPT(DNO)
);
INSERT INTO PROJECT VALUES(1, 'IOT', 'NY', 1);
INSERT INTO PROJECT VALUES(2, 'ML', 'NY', 2);
INSERT INTO PROJECT VALUES(3, 'AI', 'NY', 3);
INSERT INTO PROJECT VALUES(4, 'RPIP', 'TX', 4);
INSERT INTO PROJECT VALUES(5, 'SIMULATORS', 'TX', 5);
INSERT INTO PROJECT VALUES(6, 'SENSORS', 'TX', 5);
INSERT INTO PROJECT VALUES(7, 'STATS', 'TN', 5);

-- TRUNCATE TABLE PROJECT

CREATE TABLE WORKSON
(
    SSN INT,
    PNO INT ,
    HOURS INT,
    PRIMARY KEY(SSN,PNO),
    FOREIGN KEY(SSN) REFERENCES EMP(SSN),
    FOREIGN KEY(PNO) REFERENCES PROJECT(PNO)
);
INSERT INTO WORKSON VALUES(1, 3, 40);
INSERT INTO WORKSON VALUES (2, 4, 40);
INSERT INTO WORKSON VALUES (3, 5, 40);
INSERT INTO WORKSON VALUES (4, 6, 40);
INSERT INTO WORKSON VALUES (5, 6, 40);
INSERT INTO WORKSON VALUES (5, 7, 40);

-- QUERY 1
SELECT  P.PNO
FROM  EMP E, PROJECT P, DEPT D
WHERE E.DNO=D.DNO AND P.DNO=D.DNO AND
	D.MGRSSN=E.SSN AND E.NAME LIKE '%SCOTT'
UNION
SELECT  W.PNO
FROM  EMP E, WORKSON W
WHERE E.SSN=W.SSN AND
	E.NAME LIKE '%SCOTT';

--QUERY 2
SELECT  E.SSN, (SALARY+SALARY*0.1)  AS NEWSAL
FROM EMP E, WORKSON W, PROJECT P
WHERE E.SSN = W.SSN AND W.PNO = P.PNO AND 
	PNAME = 'IOT';

SELECT E.NAME, 1.1*E.SALARY AS INCR_SAL
FROM EMP E, WORKSON W, PROJECT P
WHERE E.SSN=W.SSN
AND W.PNO=P.PNO
AND P.PNAME='IOT';

SELECT E.NAME, 1.1*E.SALARY AS INCR_SAL
FROM EMP E, WORKSON W, PROJECT P
WHERE E.SSN=W.SSN
AND W.PNO=P.PNO
AND P.PNAME='ML';

SELECT E.NAME, 1.1*E.SALARY AS INCR_SAL
FROM EMPLOYEE E, WORKS_ON W, PROJECT P
WHERE E.SSN=W.SSN
AND W.PNO=P.PNO
AND P.PNAME='IOT';

-- Q2
SELECT SUM(E.SALARY), MAX(E.SALARY), MIN(E.SALARY), AVG(E.SALARY)
FROM EMP E, DEPT D
WHERE E.DNO=D.DNO
AND D.DNAME='ACCOUNT';
-- Q4
SELECT E.NAME
FROM EMP E
WHERE NOT EXISTS(
SELECT PNO FROM PROJECT WHERE DNO=4 AND PNO NOT IN (
SELECT PNO FROM WORKSON
WHERE E.SSN=SSN));


SELECT * FROM EMP E1
WHERE NOT EXISTS ( 
	(SELECT PNO
FROM PROJECT P
WHERE DNO=1)
	MINUS
	(SELECT PNO FROM WORKSON W
	WHERE E.SSN=E1.SSN));
-- Q5
SELECT DNO, COUNT(SSN)
FROM EMP
WHERE SALARY>10
GROUP BY DNO
HAVING COUNT(SSN)>5;
